<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>IASME Scraper — 1-File GitHub Repo Generator</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{color-scheme:light dark;--bg:#0b0c0f;--fg:#e7e7ea;--muted:#9aa0a6;--card:#111218;--border:#2a2c36;--accent:#22c55e}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font:16px/1.5 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto}
  .wrap{max-width:980px;margin:40px auto;padding:0 16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.2)}
  h1{margin:0 0 10px;font-size:26px}
  .muted{color:var(--muted)}
  button{background:linear-gradient(135deg,#22c55e,#10b981);color:#05110a;border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
  .small{font-size:14px}
  .files{margin-top:12px;border:1px dashed var(--border);border-radius:12px;padding:10px;max-height:260px;overflow:auto}
  ul{margin:.4rem 0 0 .8rem}
  code{background:#0e1117;color:#e2e8f0;border:1px solid #1f2430;border-radius:8px;padding:.15em .4em}
  pre{background:#0e1117;color:#e2e8f0;border:1px solid #1f2430;border-radius:10px;padding:10px;overflow:auto}
  a{color:#93c5fd;text-decoration:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>IASME Network Directory — Scraper/Researcher (Single-file repo)</h1>
    <p class="muted">Click the button to download a complete repo (<code>repo.zip</code>) with a Playwright-based scraper, schema validation, and a GitHub Actions workflow that runs the scraper and commits the JSONL.</p>
    <button id="zipBtn">Download repo.zip</button>
    <span id="status" class="small muted" style="margin-left:10px"></span>

    <h3 style="margin:16px 0 6px">How to use</h3>
    <ol class="small">
      <li>Unzip <code>repo.zip</code> → open the folder <code>iasme-research</code>.</li>
      <li>Create a new repo on GitHub → push the contents.</li>
      <li>Go to <strong>Actions</strong> → <strong>IASME Scrape</strong> → <strong>Run workflow</strong> (or wait for the schedule).</li>
      <li>Download the artifact or use the committed file at <code>data/iasme_companies.jsonl</code>.</li>
    </ol>

    <div class="files small">
      <strong>Files inside repo.zip</strong>
      <ul id="filelist"></ul>
    </div>

    <h3 style="margin:16px 0 6px">Run locally (optional)</h3>
    <pre>cd iasme-research
npm i
npx playwright install --with-deps chromium
npm run build
node dist/bin/iasme-research.js \
  --index https://iasme.co.uk/network-directory/ \
  --format jsonl --output out/iasme_companies.jsonl \
  --max-companies 200 --concurrency 4 --delay-ms 500 --retries 3</pre>
  </div>
</div>

<!-- ===================== EMBEDDED REPO FILES ===================== -->

<!-- package.json -->
<script type="text/plain" data-path="iasme-research/package.json">{
  "name": "iasme-research",
  "version": "1.2.0",
  "private": true,
  "type": "module",
  "bin": { "iasme-research": "dist/bin/iasme-research.js" },
  "scripts": {
    "build": "tsc -p tsconfig.json",
    "start": "node dist/bin/iasme-research.js",
    "test": "echo \"(tests omitted)\""
  },
  "dependencies": {
    "playwright": "^1.48.2",
    "p-limit": "^5.0.0",
    "yargs": "^17.7.2",
    "zod": "^3.23.8",
    "normalize-url": "^8.0.1",
    "dayjs": "^1.11.13"
  },
  "devDependencies": {
    "@types/node": "^22.7.4",
    "typescript": "^5.6.3"
  }
}
</script>

<!-- tsconfig.json -->
<script type="text/plain" data-path="iasme-research/tsconfig.json">{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ES2022",
    "moduleResolution": "Bundler",
    "outDir": "dist",
    "rootDir": ".",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "resolveJsonModule": true
  },
  "include": ["src", "bin"]
}
</script>

<!-- README -->
<script type="text/plain" data-path="iasme-research/README.md"># IASME Network Directory — Scraper/Researcher

- Scrapes the IASME directory via Playwright (renders A–Z tabs + filters; or calls a sniffed JSON feed if exposed).
- Resolves each company's website from profile/visit link/search fallback.
- Crawls likely contact pages and extracts phones, emails, address, LinkedIn company.
- Role discovery: picks the most senior **IT** and **HR** contacts from public pages (company site, press, public LinkedIn URLs found on the web), never logs in.
- Outputs validated JSONL matching the requested schema, with `sources[]` and `last_seen`.

## GitHub Actions

On push or manual dispatch, the workflow runs:
1. install deps + Playwright
2. build TS
3. run the scraper
4. upload artifact and commit `data/iasme_companies.jsonl`.

## Local

See the root `index.html` generator for local commands, or:

```bash
npm i
npx playwright install --with-deps chromium
npm run build
node dist/bin/iasme-research.js --index https://iasme.co.uk/network-directory/ --format jsonl --output out/iasme_companies.jsonl

