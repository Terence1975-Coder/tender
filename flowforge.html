<!-- file: index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Launch Control — 14-Day AI Business</title>
  <meta name="description" content="Professional 14-Day Launch Control checklist app with Firebase sync." />
  <link rel="icon" href="data:image/svg+xml;utf8,
    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
      <defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='%233b82f6'/><stop offset='0.5' stop-color='%2310b981'/><stop offset='1' stop-color='%238b5cf6'/></linearGradient></defs>
      <rect width='100' height='100' rx='18' fill='url(#g)'/>
      <path d='M25 60 L50 25 L75 60' fill='none' stroke='white' stroke-width='7' stroke-linecap='round'/>
      <circle cx='50' cy='70' r='7' fill='white'/>
    </svg>"/>
  <style>
    :root{
      --bg:#0b1020; --muted:#10162a; --card:#0f172a; --card-2:#0b1326; --text:#e6f0ff; --dim:#a9b6d3;
      --blue:#3b82f6; --green:#10b981; --purple:#8b5cf6; --red:#ef4444; --border:#1f2a44;
      --grad: linear-gradient(135deg,var(--blue), var(--green), var(--purple));
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --ring: 0 0 0 3px rgba(59,130,246,.35);
      --radius: 14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 800px at 15% -10%,rgba(59,130,246,.18),transparent),
                    radial-gradient(1200px 800px at 85% 110%,rgba(139,92,246,.16),transparent), var(--bg);
         color:var(--text); font:14px/1.5 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial}
    a{color:var(--blue); text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .header{display:flex;align-items:center;gap:16px;padding:16px 20px;background:linear-gradient(0deg,rgba(16,22,42,.65),rgba(16,22,42,.65)),var(--grad); border-radius:18px; box-shadow:var(--shadow)}
    .logo{display:flex;align-items:center;gap:12px}
    .logo svg{width:40px;height:40px;flex:none}
    .title{font-weight:700;font-size:20px;letter-spacing:.2px}
    .subtitle{opacity:.9;font-size:12px}
    .bar{margin:16px 0 22px;background:linear-gradient(135deg,rgba(59,130,246,.15),rgba(16,185,129,.15),rgba(139,92,246,.15));border:1px solid var(--border); padding:14px; border-radius:var(--radius); display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .pill{display:inline-flex;gap:8px;align-items:center; padding:6px 10px; border-radius:999px; background:#0e162b; border:1px solid var(--border); color:var(--dim); font-size:12px}
    .pill.ok{background:rgba(16,185,129,.1); color:#b8f8dd; border-color:rgba(16,185,129,.35)}
    .pill.warn{background:rgba(59,130,246,.1); color:#cfe1ff; border-color:rgba(59,130,246,.35)}
    .pill.err{background:rgba(239,68,68,.1); color:#ffd0d0; border-color:rgba(239,68,68,.35)}
    .actions{margin-left:auto; display:flex; gap:8px}
    button{all:unset; display:inline-flex; align-items:center; gap:8px; padding:10px 12px; background:var(--card); border:1px solid var(--border); border-radius:12px; cursor:pointer}
    button:hover{background:#121a31}
    .btn-primary{background:var(--grad); color:white; border:none}
    .btn-primary:hover{filter:brightness(1.05)}
    .grid{display:grid; grid-template-columns: 280px 1fr; gap:16px}
    .card{background:linear-gradient(180deg,rgba(16,22,42,.65),rgba(16,22,42,.75)); border:1px solid var(--border); border-radius:var(--radius); padding:14px; box-shadow:var(--shadow)}
    .sticky{position:sticky; top:14px}
    .h{margin:0 0 10px; font-size:13px; color:#cfe1ff; letter-spacing:.3px; text-transform:uppercase}
    .progress{height:10px; background:#0b1429; border:1px solid var(--border); border-radius:999px; overflow:hidden}
    .progress > span{display:block; height:100%; background:var(--grad)}
    .search{width:100%; background:#0b1429; border:1px solid var(--border); border-radius:10px; color:var(--text); padding:10px}
    .day{border:1px solid var(--border); border-radius:16px; overflow:hidden; margin-bottom:12px}
    .day summary{list-style:none; cursor:pointer; padding:14px 14px; background:rgba(11,20,41,.55); display:flex; align-items:center; gap:10px}
    .day summary::-webkit-details-marker{display:none}
    .k{display:inline-flex; width:20px; height:20px; align-items:center; justify-content:center; border-radius:6px; background:rgba(59,130,246,.18); border:1px solid rgba(59,130,246,.4); color:#cfe1ff; font-weight:700}
    .task{display:flex; gap:12px; align-items:flex-start; padding:12px; border-top:1px solid var(--border); background:rgba(10,16,32,.35)}
    .check{width:18px;height:18px;border-radius:5px;border:1px solid var(--border); background:#0d1530; display:inline-flex; align-items:center; justify-content:center; cursor:pointer}
    .check.done{background:linear-gradient(135deg,rgba(16,185,129,.7),rgba(59,130,246,.7))}
    .task-title{font-weight:600}
    .muted{color:var(--dim); font-size:12px}
    .drawer{padding:12px 12px 14px 38px; display:grid; gap:10px; background:rgba(12,18,34,.5); border-top:1px dashed #253253}
    .sub{display:flex; gap:8px; align-items:center}
    .sub input{accent-color:#10b981; width:16px; height:16px}
    .list{display:grid; gap:6px}
    .badge{font-size:10px; padding:2px 6px; border-radius:999px; background:#0c1530; border:1px solid var(--border); color:#cfe1ff}
    .link{display:flex; gap:8px; align-items:center}
    .footer{opacity:.6; font-size:12px; margin-top:8px}
    .code{background:#0a1328; border:1px solid var(--border); border-radius:10px; padding:10px; overflow:auto}
    .hidden{display:none}
    .row{display:flex; gap:8px; flex-wrap:wrap}
    input[type="text"], input[type="email"], textarea{width:100%; background:#0b1429; border:1px solid var(--border); border-radius:10px; color:var(--text); padding:10px}
    textarea{min-height:70px}
    .alert{padding:10px 12px; border-radius:10px; border:1px solid rgba(16,185,129,.35); background:rgba(16,185,129,.08); color:#b8f8dd; font-size:12px}
    .danger{border-color:rgba(239,68,68,.35); background:rgba(239,68,68,.08); color:#ffd0d0}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}
    @media (max-width: 900px){ .grid{grid-template-columns:1fr} .sticky{position:static} }
  </style>
  <!-- React (UMD) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Firebase compat (UMD) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/javascript">
    // Minimal "why" comments only.
    const deepClone = (v) => JSON.parse(JSON.stringify(v));
    const debounce = (fn, ms=500) => { let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), ms); } };
    const nowIso = ()=> new Date().toISOString();

    // Seed checklist (2 tasks per day to keep single-file manageable).
    const SEED = {
      days: [
        { day:1, title:"Niche & Foundations", tasks:[
          { id:"d1t1", title:"Confirm niche + teardown 3 competitors", desc:"Pick DTC micro-brands. Document gaps → hooks.",
            subtasks:[{id:"d1t1s1",t:"Pick niche & alternates"},{id:"d1t1s2",t:"3 competitor teardowns"},{id:"d1t1s3",t:"Decide ICP & angles"}],
            prompts:[
              "Give me a concise ICP for {{brand}} targeting {{niche}}: pains, triggers, messages.",
              "Tear down {{url}}: list 5 copy fixes and 3 friction removals."
            ],
            links:[{label:"Competitor Sheet (copy)", url:"https://docs.google.com"}]
          },
          { id:"d1t2", title:"Create Run Log & Dashboard shells", desc:"Observability from Day 1; UK GDPR minimal fields.",
            subtasks:[{id:"d1t2s1",t:"Create Google Sheet: Run Log"},{id:"d1t2s2",t:"Create Dashboard tabs"},{id:"d1t2s3",t:"Add UTM columns"}],
            prompts:["Design a lightweight metrics schema for K-factor, MRR, churn, signups."],
            links:[{label:"Metrics schema guide", url:"#dashboard-spec"}]
          }
        ]},
        { day:2, title:"Brand & Hub", tasks:[
          { id:"d2t1", title:"Name, tagline, logo", desc:"Text-logo + palette (blue/green/purple).",
            subtasks:[{id:"d2t1s1",t:"Pick name"},{id:"d2t1s2",t:"Confirm tagline"},{id:"d2t1s3",t:"Export SVG"}],
            prompts:["Create 5 brand names and taglines for {{niche}} with a technical, trustworthy tone."],
            links:[{label:"Logo export tip", url:"#"}]
          },
          { id:"d2t2", title:"Publish hub (Notion or Carrd)", desc:"One-scroll landing with CTAs.",
            subtasks:[{id:"d2t2s1",t:"Hero + value bullets"},{id:"d2t2s2",t:"Pricing block"},{id:"d2t2s3",t:"Footer legal links"}],
            prompts:["Write a 1-liner value prop for {{brand}} in British English."],
            links:[{label:"Landing copy draft", url:"#landing"}]
          }
        ]},
        { day:3, title:"Offer & Pricing", tasks:[
          { id:"d3t1", title:"Offer ladder & guarantee", desc:"Free → DWY → DFY → Sprint. Risk reversal.",
            subtasks:[{id:"d3t1s1",t:"Define deliverables"},{id:"d3t1s2",t:"Write guarantee"},{id:"d3t1s3",t:"Publish pricing"}],
            prompts:["Draft a measurable guarantee: '100 targeted visitors + 5 leads in 14 days' limitations included."],
            links:[{label:"Pricing model sheet", url:"#finance"}]
          },
          { id:"d3t2", title:"Legal pack skeleton", desc:"ToS, Privacy, DPA, Cookie, SLA, MSA/SOW.",
            subtasks:[{id:"d3t2s1",t:"Add company details"},{id:"d3t2s2",t:"Publish to hub"},{id:"d3t2s3",t:"Link from footer"}],
            prompts:["Summarise UK GDPR bases of processing (contract, legitimate interests, consent)."],
            links:[{label:"Privacy policy draft", url:"#legal"}]
          }
        ]},
        { day:4, title:"Lead Magnet", tasks:[
          { id:"d4t1", title:"Outline 'AI SOP Pack'", desc:"6 SOPs aligned to DTC quick wins.",
            subtasks:[{id:"d4t1s1",t:"SOP list"},{id:"d4t1s2",t:"Decide formats"},{id:"d4t1s3",t:"Cover page"}],
            prompts:["Propose 6 SOPs with outcomes, inputs, steps, QA."],
            links:[{label:"SOP template", url:"#sops"}]
          },
          { id:"d4t2", title:"Draft SOPs 1–3", desc:"UGC outreach, product copy, welcome flow.",
            subtasks:[{id:"d4t2s1",t:"UGC SOP"},{id:"d4t2s2",t:"Product copy SOP"},{id:"d4t2s3",t:"Welcome flow SOP"}],
            prompts:["Write an outreach DM <200 chars for micro-creators in {{niche}}."],
            links:[{label:"Example DM", url:"#"}]
          }
        ]},
        { day:5, title:"Lead Magnet (finish)", tasks:[
          { id:"d5t1", title:"Draft SOPs 4–6", desc:"Reviews, posting cadence, abandoned cart.",
            subtasks:[{id:"d5t1s1",t:"Reviews SOP"},{id:"d5t1s2",t:"Posting SOP"},{id:"d5t1s3",t:"Cart SOP"}],
            prompts:["Write two plain-text abandoned-cart emails (friendly tone)."]
          },
          { id:"d5t2", title:"Export PDF + delivery page", desc:"Upload to Drive, link in emails.",
            subtasks:[{id:"d5t2s1",t:"PDF export"},{id:"d5t2s2",t:"Host & link"},{id:"d5t2s3",t:"Test access"}]
          }
        ]},
        { day:6, title:"Capture & Email", tasks:[
          { id:"d6t1", title:"Tally/Google Form → Buttondown", desc:"Lead capture + consent.",
            subtasks:[{id:"d6t1s1",t:"Create form"},{id:"d6t1s2",t:"Webhook/App Script"},{id:"d6t1s3",t:"Test double opt-in"}],
            prompts:["Write a succinct consent notice for marketing in UK English."],
          },
          { id:"d6t2", title:"5-email welcome", desc:"Deliver pack + nurture → CTA DWY.",
            subtasks:[{id:"d6t2s1",t:"Draft 5 emails"},{id:"d6t2s2",t:"Schedule"},{id:"d6t2s3",t:"Click-through test"}]
          }
        ]},
        { day:7, title:"Payments & Test", tasks:[
          { id:"d7t1", title:"Stripe/Payhip products + VAT", desc:"No fixed fees; receipts enabled.",
            subtasks:[{id:"d7t1s1",t:"Create product links"},{id:"d7t1s2",t:"Enable VAT"},{id:"d7t1s3",t:"Test mode checkout"}]
          },
          { id:"d7t2", title:"Webhook → onboarding", desc:"Create Drive folder + email on payment.",
            subtasks:[{id:"d7t2s1",t:"Apps Script endpoint"},{id:"d7t2s2",t:"Drive folder copy"},{id:"d7t2s3",t:"Welcome email"}]
          }
        ]},
        { day:8, title:"Automations", tasks:[
          { id:"d8t1", title:"Run Log events + errors", desc:"Every automation logs outcome.",
            subtasks:[{id:"d8t1s1",t:"Append logs"},{id:"d8t1s2",t:"Error capture"},{id:"d8t1s3",t:"Timestamp ISO"}]
          },
          { id:"d8t2", title:"Abandoned-cart nudges", desc:"Daily pull → 2 nudges.",
            subtasks:[{id:"d8t2s1",t:"Shopify export script"},{id:"d8t2s2",t:"+2h/+24h emails"},{id:"d8t2s3",t:"Log outcomes"}]
          }
        ]},
        { day:9, title:"Launch Hub", tasks:[
          { id:"d9t1", title:"Landing v1 live", desc:"Hero, proof, features, pricing, FAQ.",
            subtasks:[{id:"d9t1s1",t:"Publish Notion/Carrd"},{id:"d9t1s2",t:"Add CTAs"},{id:"d9t1s3",t:"UTMs"}]
          },
          { id:"d9t2", title:"Analytics lite", desc:"UTM → Sheet; simple view counts.",
            subtasks:[{id:"d9t2s1",t:"View counter"},{id:"d9t2s2",t:"UTM to Run Log"},{id:"d9t2s3",t:"QA"}]
          }
        ]},
        { day:10, title:"Content Pack", tasks:[
          { id:"d10t1", title:"20 posts (LinkedIn/X)", desc:"Teardowns + CTAs.",
            subtasks:[{id:"d10t1s1",t:"Draft hooks"},{id:"d10t1s2",t:"Schedule 14 days"},{id:"d10t1s3",t:"Asset folder"}]
          },
          { id:"d10t2", title:"6 YouTube shorts scripts", desc:"≤45s; show outcomes.",
            subtasks:[{id:"d10t2s1",t:"Storyboard"},{id:"d10t2s2",t:"Captions"},{id:"d10t2s3",t:"Upload plan"}]
          }
        ]},
        { day:11, title:"Outreach (warm)", tasks:[
          { id:"d11t1", title:"100 warm targets", desc:"DM template + teardown offer.",
            subtasks:[{id:"d11t1s1",t:"Lead list"},{id:"d11t1s2",t:"30 DMs"},{id:"d11t1s3",t:"Log replies"}]
          },
          { id:"d11t2", title:"Creator DMs (10)", desc:"Gift content loop.",
            subtasks:[{id:"d11t2s1",t:"Select 10 <20k"},{id:"d11t2s2",t:"DMs"},{id:"d11t2s3",t:"Track"}]
          }
        ]},
        { day:12, title:"Outreach (cold)", tasks:[
          { id:"d12t1", title:"100 cold emails", desc:"PECR-aware, opt-out, relevant.",
            subtasks:[{id:"d12t1s1",t:"30 emails/day"},{id:"d12t1s2",t:"Track opens"},{id:"d12t1s3",t:"Book calls"}]
          },
          { id:"d12t2", title:"Community value posts", desc:"Reddit/Slack/FB.",
            subtasks:[{id:"d12t2s1",t:"Post value thread"},{id:"d12t2s2",t:"DM on request"},{id:"d12t2s3",t:"Log wins"}]
          }
        ]},
        { day:13, title:"Soft Launch", tasks:[
          { id:"d13t1", title:"Friction fixes", desc:"Collect 3 feedback items.",
            subtasks:[{id:"d13t1s1",t:"Record issues"},{id:"d13t1s2",t:"Patch copy"},{id:"d13t1s3",t:"Retest"}]
          },
          { id:"d13t2", title:"DFY upsell pack", desc:"Scope, pricing, CTA.",
            subtasks:[{id:"d13t2s1",t:"One-pager"},{id:"d13t2s2",t:"Case sketch"},{id:"d13t2s3",t:"Add to site"}]
          }
        ]},
        { day:14, title:"Public Launch", tasks:[
          { id:"d14t1", title:"Launch thread + DM follow-ups", desc:"Announce + reply.",
            subtasks:[{id:"d14t1s1",t:"Thread copy"},{id:"d14t1s2",t:"Visuals"},{id:"d14t1s3",t:"Follow-ups"}]
          },
          { id:"d14t2", title:"Referral unlocks", desc:"Prompt Pack v1.1 by 2 referrals.",
            subtasks:[{id:"d14t2s1",t:"Explain unlock"},{id:"d14t2s2",t:"Track referrals"},{id:"d14t2s3",t:"Send updates"}]
          }
        ]},
      ]
    };

    // Firebase config (from you)
    const FIREBASE_CONFIG = {
      apiKey: "AIzaSyChiAlrD-JLtBSDN3sOyxYiLGig-6Cy3GM",
      authDomain: "prospecting-f2f42.firebaseapp.com",
      databaseURL: "https://prospecting-f2f42-default-rtdb.europe-west1.firebasedatabase.app/",
      projectId: "prospecting-f2f42",
      storageBucket: "prospecting-f2f42.firebasestorage.app",
      messagingSenderId: "292034226428",
      appId: "1:292034226428:web:878b867e3eb4d3e0098f79",
      measurementId: "G-WWB0JTX2L2"
    };

    // Local persistence keys
    const LS_KEY = "lc-data";
    const LS_PROFILE = "lc-profile";
    const LS_META = "lc-meta";

    function ensureFirebase(){
      if(!firebase.apps.length){ firebase.initializeApp(FIREBASE_CONFIG); }
      return { auth: firebase.auth(), db: firebase.database() };
    }

    // Merge with precedence to source B for same keys.
    function deepMerge(a,b){ if(Array.isArray(a) && Array.isArray(b)) return b.length ? b : a;
      if(a && typeof a==='object' && b && typeof b==='object'){ const o={...a}; for(const k of Object.keys(b)){ o[k]=deepMerge(a[k],b[k]); } return o; }
      return b ?? a;
    }

    function App(){
      const { useEffect, useMemo, useState, useRef } = React;
      const [profile,setProfile] = useState(()=> JSON.parse(localStorage.getItem(LS_PROFILE) || "{}") || {});
      const [data,setData] = useState(()=> JSON.parse(localStorage.getItem(LS_KEY) || "null") || deepClone(SEED));
      const [uid,setUid] = useState(null);
      const [saveState,setSaveState] = useState({status:"idle", ts:null, msg:""});
      const [conn,setConn] = useState({online:navigator.onLine, firebase:"init"});
      const [q,setQ] = useState("");
      const [openTask,setOpenTask] = useState(null);
      const saveQueued = useRef(false);
      const dbPath = useMemo(()=> uid ? `users/${uid}/projects/default` : null, [uid]);

      // Connectivity listeners
      useEffect(()=>{
        const on = ()=> setConn(s=>({...s,online:true}));
        const off = ()=> setConn(s=>({...s,online:false}));
        window.addEventListener("online", on);
        window.addEventListener("offline", off);
        return ()=>{ window.removeEventListener("online", on); window.removeEventListener("offline", off); }
      },[]);

      // Firebase init + anon auth
      useEffect(()=>{
        const {auth,db} = ensureFirebase();
        setConn(s=>({...s,firebase:"init"}));
        auth.onAuthStateChanged(async u=>{
          if(u){ setUid(u.uid); setConn(s=>({...s,firebase:"authed"})); // Load remote → merge
            try{
              const snap = await db.ref(dbPath).get();
              const remote = snap.exists() ? snap.val() : null;
              if(remote){
                // "Why": prefer latest by timestamp when both exist
                const meta = JSON.parse(localStorage.getItem(LS_META)||"{}");
                const merged = deepMerge(remote.data||{}, data);
                setData(merged);
              }
            }catch(e){ setConn(s=>({...s,firebase:"error"})); setSaveState({status:"error", ts:nowIso(), msg:e.message}); }
          } else {
            try{ await auth.signInAnonymously(); }catch(e){ setConn(s=>({...s,firebase:"error"})); }
          }
        });
      },[]);

      // Persist local (always)
      useEffect(()=>{ localStorage.setItem(LS_KEY, JSON.stringify(data)); }, [data]);
      useEffect(()=>{ localStorage.setItem(LS_PROFILE, JSON.stringify(profile)); }, [profile]);

      const total = useMemo(()=>{
        let sub=0, done=0;
        for(const d of data.days){
          for(const t of d.tasks){ for(const s of t.subtasks){ sub++; if(s.done) done++; } }
        }
        return {sub,done, pct: sub? Math.round(done*100/sub):0};
      },[data]);

      const requestSave = useMemo(()=> debounce(async (payload)=>{
        if(!uid){ saveQueued.current=true; return; }
        const {db} = ensureFirebase();
        setSaveState({status:"saving", ts:nowIso(), msg:""});
        try{
          await db.ref(dbPath).set({ data: payload, profile, updatedAt: nowIso(), v:1 });
          setSaveState({status:"saved", ts:nowIso(), msg:""});
          setConn(s=>({...s,firebase:"ok"}));
          saveQueued.current=false;
        }catch(e){
          setSaveState({status:"error", ts:nowIso(), msg:e.message});
        }
      },500), [uid, dbPath, profile]);

      // Save on changes
      useEffect(()=>{ requestSave(data); }, [data, requestSave]);

      function toggleSub(dayIdx, taskIdx, subIdx){
        const next = deepClone(data);
        const s = next.days[dayIdx].tasks[taskIdx].subtasks[subIdx];
        s.done = !s.done;
        setData(next);
      }

      function setNote(dayIdx, taskIdx, text){
        const next = deepClone(data);
        next.days[dayIdx].tasks[taskIdx].note = text;
        setData(next);
      }

      function copyText(txt){
        navigator.clipboard.writeText(txt).catch(()=>{ /* ignore */ });
      }

      function exportJson(){
        const blob = new Blob([JSON.stringify({profile,data},null,2)], {type:"application/json"});
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob); a.download = "launch-control-export.json"; a.click();
      }

      function importJson(file){
        const r = new FileReader();
        r.onload = ()=> {
          try{ const pkg = JSON.parse(r.result);
            if(pkg.profile) setProfile(pkg.profile);
            if(pkg.data) setData(pkg.data);
          }catch(e){ alert("Invalid JSON."); }
        };
        r.readAsText(file);
      }

      async function runDiagnostics(){
        const {db} = ensureFirebase();
        const path = dbPath ? dbPath+"/_diag" : null;
        const out = [];
        if(!dbPath){ alert("Not authed yet."); return; }
        try{
          await db.ref(path).set({ ping:nowIso() });
          const snap = await db.ref(path).get();
          if(snap.exists()) out.push("DB write/read: PASS");
          else out.push("DB write/read: FAIL");
        }catch(e){ out.push("DB error: "+e.message); }
        alert(out.join("\n"));
      }

      const filtered = useMemo(()=>{
        if(!q.trim()) return data.days;
        const qq=q.toLowerCase();
        return data.days.map(d=>({
          ...d,
          tasks: d.tasks.filter(t =>
            t.title.toLowerCase().includes(qq) ||
            (t.desc||"").toLowerCase().includes(qq) ||
            (t.prompts||[]).some(p=>p.toLowerCase().includes(qq)))
        })).filter(d=>d.tasks.length);
      },[q,data]);

      function resetAll(){
        if(confirm("Reset all local + remote data?")) {
          setData(deepClone(SEED));
          setProfile({});
          const {db} = ensureFirebase();
          if(dbPath) db.ref(dbPath).remove().catch(()=>{});
        }
      }

      return React.createElement(React.Fragment,null,
        React.createElement("div",{className:"wrap"},
          React.createElement("div",{className:"header"},
            React.createElement("div",{className:"logo",title:"Launch Control"},
              // Inline SVG logo
              (function(){
                const svg = `
                  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 48'>
                    <defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='#3b82f6'/><stop offset='0.5' stop-color='#10b981'/><stop offset='1' stop-color='#8b5cf6'/></linearGradient></defs>
                    <rect x='0' y='0' width='48' height='48' rx='12' fill='url(#g)'/>
                    <path d='M14 30 L24 14 L34 30' fill='none' stroke='white' stroke-width='4' stroke-linecap='round'/>
                    <circle cx='24' cy='34' r='4' fill='white'/>
                    <text x='58' y='31' font-family='Inter, Arial' font-size='18' font-weight='700' fill='white'>Launch Control</text>
                  </svg>`;
                const div = document.createElement("div"); div.innerHTML=svg; return div.firstChild;
              })()
            ),
            React.createElement("div",null,
              React.createElement("div",{className:"title"},"14-Day AI Business — Launch Control"),
              React.createElement("div",{className:"subtitle"},"Professional technical checklist • Blue/Green/Purple theme • Firebase sync")
            )
          ),
          React.createElement("div",{className:"bar"},
            React.createElement("div",{className:`pill ${conn.online?'ok':'err'}`}, "Online: ", conn.online?"Yes":"No"),
            React.createElement("div",{className:`pill ${conn.firebase==='ok' || conn.firebase==='authed'?'ok': (conn.firebase==='error'?'err':'warn')}`},
              "Firebase: ", conn.firebase, uid?` • uid:${uid.slice(0,8)}…`:""),
            React.createElement("div",{className:`pill ${saveState.status==='saved'?'ok': (saveState.status==='error'?'err':'warn')}`},
              "Save: ", saveState.status, saveState.ts?` • ${new Date(saveState.ts).toLocaleTimeString()}`:""),
            React.createElement("div",{className:"actions"},
              React.createElement("button",{className:"btn-primary", onClick:()=>exportJson()}, "Export"),
              React.createElement("label",{className:"pill", style:{cursor:"pointer"}},
                "Import",
                React.createElement("input",{type:"file", accept:"application/json", className:"hidden", onChange:(e)=> e.target.files[0] && importJson(e.target.files[0])})
              ),
              React.createElement("button",{onClick:runDiagnostics},"Diagnostics"),
              React.createElement("button",{onClick:resetAll, style:{color:"#ffd0d0", borderColor:"rgba(239,68,68,.35)"}}, "Reset")
            )
          ),

          React.createElement("div",{className:"grid"},
            // Sidebar
            React.createElement("aside",{className:"card sticky"},
              React.createElement("div",{className:"h"},"Settings"),
              React.createElement("div",{className:"row"},
                React.createElement("input",{type:"text", placeholder:"Brand (e.g., FlowForge.AI)", value:profile.brand||"", onChange:e=>setProfile({...profile,brand:e.target.value})}),
                React.createElement("input",{type:"text", placeholder:"Niche (e.g., DTC micro-brands)", value:profile.niche||"", onChange:e=>setProfile({...profile,niche:e.target.value})}),
                React.createElement("input",{type:"text", placeholder:"Site URL", value:profile.site||"", onChange:e=>setProfile({...profile,site:e.target.value})}),
                React.createElement("input",{type:"email", placeholder:"Email", value:profile.email||"", onChange:e=>setProfile({...profile,email:e.target.value})})
              ),
              React.createElement("div",{className:"h", style:{marginTop:12}},"Progress"),
              React.createElement("div",{className:"progress", title: total.pct+"%"},
                React.createElement("span",{style:{width: total.pct+"%"}})
              ),
              React.createElement("div",{className:"muted", style:{marginTop:6}}, `${total.done}/${total.sub} subtasks • ${total.pct}%`),
              React.createElement("div",{className:"h", style:{marginTop:14}},"Search"),
              React.createElement("input",{className:"search", placeholder:"Find task or prompt…", value:q, onChange:e=>setQ(e.target.value)}),
              React.createElement("div",{className:"h", style:{marginTop:14}},"Realtime DB Rules"),
              React.createElement("div",{className:"code mono", style:{fontSize:"12px"}},
`{
  "rules": {
    ".read": false,
    ".write": false,
    "users": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": "auth != null && auth.uid === $uid"
      }
    }
  }
}`),
              React.createElement("div",{className:"h", style:{marginTop:14}},"Notes"),
              React.createElement("div",{className:"alert"},"Anon auth + user-scoped rules keep data isolated. Keep PII minimal (UK GDPR).")
            ),

            // Main
            React.createElement("main",null,
              filtered.map((d,di)=>(
                React.createElement("details",{key:d.day, className:"day", open:true},
                  React.createElement("summary",null,
                    React.createElement("span",{className:"k"}, d.day),
                    React.createElement("div",null,
                      React.createElement("div",{className:"task-title"}, `Day ${d.day} — ${d.title}`),
                      React.createElement("div",{className:"muted"},"Click to expand tasks")
                    )
                  ),
                  d.tasks.map((t,ti)=>(
                    React.createElement("div",{key:t.id, className:"task"},
                      React.createElement("div",{className:`check ${ (t.subtasks||[]).every(s=>s.done)?'done':'' }`, onClick:()=>{
                        const next = deepClone(data);
                        const all = next.days[di].tasks[ti].subtasks;
                        const setTo = !(all||[]).every(s=>s.done);
                        (all||[]).forEach(s=> s.done=setTo);
                        setData(next);
                      }}, "✓"),
                      React.createElement("div",{style:{flex:1}},
                        React.createElement("div",{className:"task-title"}, t.title),
                        React.createElement("div",{className:"muted"}, t.desc||""),
                        React.createElement("div",{className:"row", style:{marginTop:8}},
                          React.createElement("span",{className:"badge"}, `${(t.subtasks||[]).filter(s=>s.done).length}/${(t.subtasks||[]).length} done`),
                          React.createElement("button",{onClick:()=> setOpenTask({di,ti})}, "Open"),
                          React.createElement("button",{onClick:()=>{
                            const next=deepClone(data);
                            next.days[di].tasks[ti].subtasks.forEach(s=> s.done=false);
                            setData(next);
                          }}, "Clear")
                        ),
                        openTask && openTask.di===di && openTask.ti===ti && React.createElement("div",{className:"drawer"},
                          React.createElement("div",{className:"list"},
                            (t.subtasks||[]).map((s,si)=> React.createElement("label",{className:"sub", key:s.id},
                              React.createElement("input",{type:"checkbox", checked:!!s.done, onChange:()=>toggleSub(di,ti,si)}),
                              React.createElement("span",null, s.t)
                            ))
                          ),
                          (t.prompts && t.prompts.length>0) && React.createElement("div",null,
                            React.createElement("div",{className:"h"},"Prompts"),
                            t.prompts.map((p,idx)=> React.createElement("div",{key:idx, className:"card"},
                              React.createElement("div",{className:"muted"},"Prompt ", idx+1),
                              React.createElement("div",{className:"code"}, p
                                .replaceAll("{{brand}}", profile.brand||"your brand")
                                .replaceAll("{{niche}}", profile.niche||"your niche")),
                              React.createElement("div",{className:"row"},
                                React.createElement("button",{className:"btn-primary", onClick:()=>copyText(
                                  p.replaceAll("{{brand}}", profile.brand||"your brand")
                                   .replaceAll("{{niche}}", profile.niche||"your niche")
                                   .replaceAll("{{url}}", profile.site||"https://")
                                )},"Copy"),
                                React.createElement("button",{onClick:()=>window.open("https://chat.openai.com","_blank")},"Open AI")
                              )
                            ))
                          ),
                          (t.links && t.links.length>0) && React.createElement("div",null,
                            React.createElement("div",{className:"h"},"Links"),
                            t.links.map((l,i)=> React.createElement("div",{className:"link", key:i},
                              React.createElement("span",{className:"badge"}, "Link"),
                              React.createElement("a",{href:l.url, target:"_blank", rel:"noreferrer"}, l.label)
                            ))
                          ),
                          React.createElement("div",null,
                            React.createElement("div",{className:"h"},"Notes"),
                            React.createElement("textarea",{value:t.note||"", onChange:e=>setNote(di,ti,e.target.value), placeholder:"Decisions, URLs, status…"})
                          ),
                          React.createElement("div",{className:"footer"},"Autosaves to Firebase (when online) and localStorage.")
                        )
                      )
                    )
                  ))
                )
              ))
            )
          ),

          React.createElement("div",{id:"dashboard-spec", className:"footer"}, "Dashboard schema: Date | Sessions | Leads | CVR | Checkouts | MRR | Churn | K-factor | List size | UGC | Reviews")
        )
      );
    }

    // Render
    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(App));
  </script>
</body>
</html>
